geom_errorbar(data = reshaped_error,
aes(x = question,
ymax = up,
ymin = low),
width = .15) +
geom_hline(yintercept = 0.50, linetype = "dashed", color = "black", size = 0.5) +
coord_flip() +
theme_classic() # versione base, poi puoi arricchirlo come ti piace
ggplot(reshaped,
aes(fill = mod,
y = answer,
x = question)) +
geom_bar(stat = "identity",
position = "fill",
width = 0.75) +
geom_errorbar(data = reshaped_error,
aes(x = question,
ymax = up,
ymin = low),
width = .15) +
geom_hline(yintercept = 0.50, linetype = "dashed", color = "white", size = 0.5) +
coord_flip() +
theme_classic() # versione base, poi puoi arricchirlo come ti piace
ggplot(reshaped,
aes(fill = mod,
y = answer,
x = question)) +
geom_bar(stat = "identity",
position = "fill",
width = 0.75) +
geom_errorbar(data = reshaped_error,
aes(x = question,
ymax = up,
ymin = low),
width = .15) +
geom_hline(yintercept = 0.50, linetype = "dashed", color = "white", size = 0.5) +
coord_flip() +
theme_classic(base_size = 14, base_family = "Helvetica") # versione base, poi puoi arricchirlo come ti piace
ggplot(reshaped,
aes(fill = mod,
y = answer,
x = question)) +
geom_bar(stat = "identity",
position = "fill",
width = 0.75) +
geom_errorbar(data = reshaped_error,
aes(x = question,
ymax = up,
ymin = low),
width = .15) +
geom_hline(yintercept = 0.50, linetype = "dashed", color = "white", size = 0.5) +
coord_flip() +
theme_classic(base_size = 12, base_family = "Helvetica") # versione base, poi puoi arricchirlo come ti piace
theme(axis.text.x=element_text(size=9)) +
theme(axis.title.y=element_text(size=12, face="bold", vjust=1)) +
theme(axis.text.y=element_text(hjust=1,vjust=1, size=10)) +
# theme(legend.position="right")
# da qui riprende tuo script ----------------------------------------------
df_stack <- t(df_stack)
theme(axis.text.x=element_text(size=9)) +
theme(axis.title.y=element_text(size=12, face="bold", vjust=1)) +
theme(axis.text.y=element_text(hjust=1,vjust=1, size=10))
ggplot(reshaped,
aes(fill = mod,
y = answer,
x = question)) +
geom_bar(stat = "identity",
position = "fill",
width = 0.75) +
geom_errorbar(data = reshaped_error,
aes(x = question,
ymax = up,
ymin = low),
width = .15) +
geom_hline(yintercept = 0.50, linetype = "dashed", color = "white", size = 0.5) +
coord_flip() +
theme_classic(base_size = 12, base_family = "Helvetica") + # versione base, poi puoi arricchirlo come ti piace
theme(axis.text.x=element_text(size=9)) +
theme(axis.title.y=element_text(size=12, face="bold", vjust=1)) +
theme(axis.text.y=element_text(hjust=1,vjust=1, size=10))
ggplot(reshaped,
aes(fill = mod,
y = answer,
x = question)) +
geom_bar(stat = "identity",
position = "fill",
width = 0.75) +
geom_errorbar(data = reshaped_error,
aes(x = question,
ymax = up,
ymin = low),
width = .15) +
geom_hline(yintercept = 0.50, linetype = "dashed", color = "white", size = 0.5) +
coord_flip() +
theme_classic(base_size = 12, base_family = "Helvetica") + # versione base, poi puoi arricchirlo come ti piace
theme(axis.text.x=element_text(size=9)) +
theme(axis.title.y=element_text(size=12, face="bold", vjust=1)) +
theme(axis.title.x=element_text(size=12, face="bold", vjust=1)) +
theme(axis.text.y=element_text(hjust=1,vjust=1, size=10))
theme(legend.position="right", face = 'bold')
ggplot(reshaped,
aes(fill = mod,
y = answer,
x = question)) +
geom_bar(stat = "identity",
position = "fill",
width = 0.75) +
geom_errorbar(data = reshaped_error,
aes(x = question,
ymax = up,
ymin = low),
width = .15) +
geom_hline(yintercept = 0.50, linetype = "dashed", color = "white", size = 0.5) +
coord_flip() +
theme_classic(base_size = 12, base_family = "Helvetica") + # versione base, poi puoi arricchirlo come ti piace
theme(axis.text.x=element_text(size=9)) +
theme(axis.title.y=element_text(size=12, face="bold", vjust=1)) +
theme(axis.title.x=element_text(size=12, face="bold", vjust=1)) +
theme(axis.text.y=element_text(hjust=1,vjust=1, size=10)) +
theme(legend.position="right", face = 'bold')
ggplot(reshaped,
aes(fill = mod,
y = answer,
x = question)) +
geom_bar(stat = "identity",
position = "fill",
width = 0.75) +
geom_errorbar(data = reshaped_error,
aes(x = question,
ymax = up,
ymin = low),
width = .15) +
geom_hline(yintercept = 0.50, linetype = "dashed", color = "white", size = 0.5) +
coord_flip() +
theme_classic(base_size = 12, base_family = "Helvetica") + # versione base, poi puoi arricchirlo come ti piace
theme(axis.text.x=element_text(size=9)) +
theme(axis.title.y=element_text(size=12, face="bold", vjust=1)) +
theme(axis.title.x=element_text(size=12, face="bold", vjust=1)) +
theme(axis.text.y=element_text(hjust=1,vjust=1, size=10))
ggplot(reshaped,
aes(fill = mod,
y = answer,
x = question)) +
geom_bar(stat = "identity",
position = "fill",
width = 0.75) +
geom_errorbar(data = reshaped_error,
aes(x = question,
ymax = up,
ymin = low),
width = .15) +
geom_hline(yintercept = 0.50, linetype = "dashed", color = "white", size = 0.5) +
coord_flip() +
theme_classic(base_size = 12, base_family = "Helvetica") + # versione base, poi puoi arricchirlo come ti piace
theme(axis.text.x=element_text(size=10)) +
theme(axis.title.y=element_text(size=14, face="bold", vjust=1)) +
theme(axis.title.x=element_text(size=14, face="bold", vjust=1)) +
theme(axis.text.y=element_text(hjust=1,vjust=1, size=10))
ggplot(reshaped,
aes(fill = mod,
y = answer,
x = question)) +
geom_bar(stat = "identity",
position = "fill",
width = 0.75) +
geom_errorbar(data = reshaped_error,
aes(x = question,
ymax = up,
ymin = low),
width = .15) +
geom_hline(yintercept = 0.50, linetype = "dashed", color = "white", size = 0.5) +
coord_flip() +
geom_text(aes(label = label), position = position_stack(vjust = 0.5), size = 2) +
theme_classic(base_size = 12, base_family = "Helvetica") + # versione base, poi puoi arricchirlo come ti piace
theme(axis.text.x=element_text(size=10)) +
theme(axis.title.y=element_text(size=14, face="bold", vjust=1)) +
theme(axis.title.x=element_text(size=14, face="bold", vjust=1)) +
theme(axis.text.y=element_text(hjust=1,vjust=1, size=10))
ggplot(reshaped,
aes(fill = mod,
y = answer,
x = question)) +
geom_bar(stat = "identity",
position = "fill",
width = 0.75) +
geom_errorbar(data = reshaped_error,
aes(x = question,
ymax = up,
ymin = low),
width = .15) +
geom_hline(yintercept = 0.50, linetype = "dashed", color = "white", size = 0.5) +
coord_flip() +
geom_text(aes(label = reshaped$answer), position = position_stack(vjust = 0.5), size = 2) +
theme_classic(base_size = 12, base_family = "Helvetica") + # versione base, poi puoi arricchirlo come ti piace
theme(axis.text.x=element_text(size=10)) +
theme(axis.title.y=element_text(size=14, face="bold", vjust=1)) +
theme(axis.title.x=element_text(size=14, face="bold", vjust=1)) +
theme(axis.text.y=element_text(hjust=1,vjust=1, size=10))
ggplot(reshaped,
aes(fill = mod,
y = answer,
x = question)) +
geom_bar(stat = "identity",
position = "fill",
width = 0.75) +
geom_errorbar(data = reshaped_error,
aes(x = question,
ymax = up,
ymin = low),
width = .15) +
geom_hline(yintercept = 0.50, linetype = "dashed", color = "white", size = 0.5) +
coord_flip() +
geom_text(aes(label = reshaped$answer*100), position = position_stack(vjust = 0.5), size = 2) +
theme_classic(base_size = 12, base_family = "Helvetica") + # versione base, poi puoi arricchirlo come ti piace
theme(axis.text.x=element_text(size=10)) +
theme(axis.title.y=element_text(size=14, face="bold", vjust=1)) +
theme(axis.title.x=element_text(size=14, face="bold", vjust=1)) +
theme(axis.text.y=element_text(hjust=1,vjust=1, size=10))
ggplot(reshaped,
aes(fill = mod,
y = answer,
x = question)) +
geom_bar(stat = "identity",
position = "fill",
width = 0.75) +
geom_errorbar(data = reshaped_error,
aes(x = question,
ymax = up,
ymin = low),
width = .15) +
geom_hline(yintercept = 0.50, linetype = "dashed", color = "white", size = 0.5) +
coord_flip() +
geom_text(aes(label = format(round(reshaped$answer*100, 2))), position = position_stack(vjust = 0.5), size = 2) +
theme_classic(base_size = 12, base_family = "Helvetica") + # versione base, poi puoi arricchirlo come ti piace
theme(axis.text.x=element_text(size=10)) +
theme(axis.title.y=element_text(size=14, face="bold", vjust=1)) +
theme(axis.title.x=element_text(size=14, face="bold", vjust=1)) +
theme(axis.text.y=element_text(hjust=1,vjust=1, size=10))
ggplot(reshaped,
aes(fill = mod,
y = answer,
x = question)) +
geom_bar(stat = "identity",
position = "fill",
width = 0.75) +
geom_errorbar(data = reshaped_error,
aes(x = question,
ymax = up,
ymin = low),
width = .15) +
geom_hline(yintercept = 0.50, linetype = "dashed", color = "white", size = 0.5) +
coord_flip() +
geom_text(aes(label = format(round(reshaped$answer*100, 1))), position = position_stack(vjust = 0.5), size = 2) +
theme_classic(base_size = 12, base_family = "Helvetica") + # versione base, poi puoi arricchirlo come ti piace
theme(axis.text.x=element_text(size=10)) +
theme(axis.title.y=element_text(size=14, face="bold", vjust=1)) +
theme(axis.title.x=element_text(size=14, face="bold", vjust=1)) +
theme(axis.text.y=element_text(hjust=1,vjust=1, size=10))
ggplot(reshaped,
aes(fill = mod,
y = answer,
x = question)) +
geom_bar(stat = "identity",
position = "fill",
width = 0.75) +
geom_errorbar(data = reshaped_error,
aes(x = question,
ymax = up,
ymin = low),
width = .15) +
geom_hline(yintercept = 0.50, linetype = "dashed", color = "white", size = 0.5) +
coord_flip() +
geom_text(aes(label = format(round(reshaped$answer*100, 1))), position = position_stack(vjust = 0.5), size = 5) +
theme_classic(base_size = 12, base_family = "Helvetica") + # versione base, poi puoi arricchirlo come ti piace
theme(axis.text.x=element_text(size=10)) +
theme(axis.title.y=element_text(size=14, face="bold", vjust=1)) +
theme(axis.title.x=element_text(size=14, face="bold", vjust=1)) +
theme(axis.text.y=element_text(hjust=1,vjust=1, size=10))
ggplot(reshaped,
aes(fill = mod,
y = answer,
x = question)) +
geom_bar(stat = "identity",
position = "fill",
width = 0.75) +
geom_errorbar(data = reshaped_error,
aes(x = question,
ymax = up,
ymin = low),
width = .15) +
geom_hline(yintercept = 0.50, linetype = "dashed", color = "white", size = 0.5) +
coord_flip() +
geom_text(aes(label = format(round(reshaped$answer*100, 1))), position = position_stack(vjust = 0.5), size = 3) +
theme_classic(base_size = 12, base_family = "Helvetica") + # versione base, poi puoi arricchirlo come ti piace
theme(axis.text.x=element_text(size=10)) +
theme(axis.title.y=element_text(size=14, face="bold", vjust=1)) +
theme(axis.title.x=element_text(size=14, face="bold", vjust=1)) +
theme(axis.text.y=element_text(hjust=1,vjust=1, size=10))
ggplot(reshaped,
aes(fill = mod,
y = answer,
x = question)) +
geom_bar(stat = "identity",
position = "fill",
width = 0.75) +
geom_errorbar(data = reshaped_error,
aes(x = question,
ymax = up,
ymin = low),
width = .15) +
geom_hline(yintercept = 0.50, linetype = "dashed", color = "white", size = 0.5) +
coord_flip() +
geom_text(aes(label = format(round(reshaped$answer*100, 1))), position = position_stack(vjust = 0.5), size = 3, color = 'white') +
theme_classic(base_size = 12, base_family = "Helvetica") + # versione base, poi puoi arricchirlo come ti piace
theme(axis.text.x=element_text(size=10)) +
theme(axis.title.y=element_text(size=14, face="bold", vjust=1)) +
theme(axis.title.x=element_text(size=14, face="bold", vjust=1)) +
theme(axis.text.y=element_text(hjust=1,vjust=1, size=10))
ggplot(reshaped,
aes(fill = mod,
y = answer,
x = question)) +
geom_bar(stat = "identity",
position = "fill",
width = 0.75) +
geom_errorbar(data = reshaped_error,
aes(x = question,
ymax = up,
ymin = low),
width = .15) +
geom_hline(yintercept = 0.50, linetype = "dashed", color = "white", size = 0.5) +
coord_flip() +
geom_text(aes(label = format(round(reshaped$answer*100, 1))), position = position_stack(vjust = 0.75), size = 3, color = 'white') +
theme_classic(base_size = 12, base_family = "Helvetica") + # versione base, poi puoi arricchirlo come ti piace
theme(axis.text.x=element_text(size=10)) +
theme(axis.title.y=element_text(size=14, face="bold", vjust=1)) +
theme(axis.title.x=element_text(size=14, face="bold", vjust=1)) +
theme(axis.text.y=element_text(hjust=1,vjust=1, size=10))
ggplot(reshaped,
aes(fill = mod,
y = answer,
x = question)) +
geom_bar(stat = "identity",
position = "fill",
width = 0.75) +
geom_errorbar(data = reshaped_error,
aes(x = question,
ymax = up,
ymin = low),
width = .15) +
geom_hline(yintercept = 0.50, linetype = "dashed", color = "white", size = 0.5) +
coord_flip() +
geom_text(aes(label = format(round(reshaped$answer*100, 1))), position = position_stack(vjust = 0.2), size = 3, color = 'white') +
theme_classic(base_size = 12, base_family = "Helvetica") + # versione base, poi puoi arricchirlo come ti piace
theme(axis.text.x=element_text(size=10)) +
theme(axis.title.y=element_text(size=14, face="bold", vjust=1)) +
theme(axis.title.x=element_text(size=14, face="bold", vjust=1)) +
theme(axis.text.y=element_text(hjust=1,vjust=1, size=10))
ggplot(reshaped,
aes(fill = mod,
y = answer,
x = question)) +
geom_bar(stat = "identity",
position = "fill",
width = 1.25) +
geom_errorbar(data = reshaped_error,
aes(x = question,
ymax = up,
ymin = low),
width = .15) +
geom_hline(yintercept = 0.50, linetype = "dashed", color = "white", size = 0.5) +
coord_flip() +
geom_text(aes(label = format(round(reshaped$answer*100, 1))), position = position_stack(vjust = 0.5), size = 3, color = 'white') +
theme_classic(base_size = 12, base_family = "Helvetica") + # versione base, poi puoi arricchirlo come ti piace
theme(axis.text.x=element_text(size=10)) +
theme(axis.title.y=element_text(size=14, face="bold", vjust=1)) +
theme(axis.title.x=element_text(size=14, face="bold", vjust=1)) +
theme(axis.text.y=element_text(hjust=1,vjust=1, size=10))
ggplot(reshaped,
aes(fill = mod,
y = answer,
x = question)) +
geom_bar(stat = "identity",
position = "fill",
width = 0.95) +
geom_errorbar(data = reshaped_error,
aes(x = question,
ymax = up,
ymin = low),
width = .15) +
geom_hline(yintercept = 0.50, linetype = "dashed", color = "white", size = 0.5) +
coord_flip() +
geom_text(aes(label = format(round(reshaped$answer*100, 1))), position = position_stack(vjust = 0.5), size = 3, color = 'white') +
theme_classic(base_size = 12, base_family = "Helvetica") + # versione base, poi puoi arricchirlo come ti piace
theme(axis.text.x=element_text(size=10)) +
theme(axis.title.y=element_text(size=14, face="bold", vjust=1)) +
theme(axis.title.x=element_text(size=14, face="bold", vjust=1)) +
theme(axis.text.y=element_text(hjust=1,vjust=1, size=10))
ggplot(reshaped,
aes(fill = mod,
y = answer,
x = question)) +
geom_bar(stat = "identity",
position = "fill",
width = 0.95) +
geom_errorbar(data = reshaped_error,
aes(x = question,
ymax = up,
ymin = low),
width = .15) +
geom_hline(yintercept = 0.50, linetype = "dashed", color = "white", size = 0.5) +
coord_flip() +
geom_text(aes(label = format(round(reshaped$answer*100, 1))), position = position_stack(vjust = 0.5, hjust = 0.1), size = 3, color = 'white') +
theme_classic(base_size = 12, base_family = "Helvetica") + # versione base, poi puoi arricchirlo come ti piace
theme(axis.text.x=element_text(size=10)) +
theme(axis.title.y=element_text(size=14, face="bold", vjust=1)) +
theme(axis.title.x=element_text(size=14, face="bold", vjust=1)) +
theme(axis.text.y=element_text(hjust=1,vjust=1, size=10))
ggplot(reshaped,
aes(fill = mod,
y = answer,
x = question)) +
geom_bar(stat = "identity",
position = "fill",
width = 0.95) +
geom_errorbar(data = reshaped_error,
aes(x = question,
ymax = up,
ymin = low),
width = .15) +
geom_hline(yintercept = 0.50, linetype = "dashed", color = "white", size = 0.5) +
coord_flip() +
geom_text(aes(label = format(round(reshaped$answer*100, 1))), position = position_stack(vjust = 0.5), size = 3, color = 'white') +
theme_classic(base_size = 12, base_family = "Helvetica") + # versione base, poi puoi arricchirlo come ti piace
theme(axis.text.x=element_text(size=10)) +
theme(axis.title.y=element_text(size=14, face="bold", vjust=1)) +
theme(axis.title.x=element_text(size=14, face="bold", vjust=1)) +
theme(axis.text.y=element_text(hjust=1,vjust=1, size=10))
#df <- read.csv('Questionario psicometrico (VIZ_1).csv')
df <- read.table('https://raw.githubusercontent.com/DBertazioli/ARmeetup/master/Visualizations/survey/Questionario%20psicometrico%20(VIZ_1).txt', header = TRUE, sep = ",")
df_corr <- df[,-1]
df_corr <- df_corr[, -7]
mcor <- cor(df_corr, method = 'pearson')
library(corrplot)
corrplot(mcor, method = 'circle',
type = 'upper', order = 'hclust', tl.col = 'black',
tl.srt = 45, tl.cex = 0.7, addCoef.col  = 'black', number.cex = 0.85)
corrplot(mcor, method = 'circle',
type = 'upper', order = 'hclust', tl.col = 'black',
tl.srt = 45, tl.cex = 0.7, addCoef.col  = 'black', number.cex = 0.85,
cl.lim=c(0,1), col=colorRampPalette(c("blue","white","red"))(200))
corrplot(mcor, method = 'circle',
type = 'upper', order = 'hclust', tl.col = 'black',
tl.srt = 45, tl.cex = 0.7, addCoef.col  = 'black', number.cex = 0.85,
cl.lim=c(0,1), col=colorRampPalette(c("blue","#ffad33","red"))(200))
corrplot(mcor, method = 'circle',
type = 'upper', order = 'hclust', tl.col = 'black',
tl.srt = 45, tl.cex = 0.7, addCoef.col  = 'black', number.cex = 0.85,
cl.lim=c(0,1), col=colorRampPalette(c("blue","#ffad33","#80ccff"))(200))
corrplot(mcor, method = 'circle',
type = 'upper', order = 'hclust', tl.col = 'black',
tl.srt = 45, tl.cex = 0.7, addCoef.col  = 'black', number.cex = 0.85,
cl.lim=c(0,1), col=colorRampPalette(c("blue","#ffad33","#80ccff"))(5))
corrplot(mcor, method = 'circle',
type = 'upper', order = 'hclust', tl.col = 'black',
tl.srt = 45, tl.cex = 0.7, addCoef.col  = 'black', number.cex = 0.85,
cl.lim=c(0,1), col=colorRampPalette(c("blue","#ffad33","#80ccff"))(500))
corrplot(mcor, method = 'circle',
type = 'upper', order = 'hclust', tl.col = 'black',
tl.srt = 45, tl.cex = 0.7, addCoef.col  = 'black', number.cex = 0.85,
cl.lim=c(0,1), col=colorRampPalette(c("blue","#ffad33","#80ccff"))(100))
corrplot(mcor, method = 'circle',
type = 'upper', order = 'hclust', tl.col = 'black',
tl.srt = 45, tl.cex = 0.7, addCoef.col  = 'black', number.cex = 0.85,
cl.lim=c(0,1), col=colorRampPalette(c("blue","#ffad33","#80ccff"))(10))
corrplot(mcor, method = 'circle',
type = 'upper', order = 'hclust', tl.col = 'black',
tl.srt = 45, tl.cex = 0.7, addCoef.col  = 'black', number.cex = 0.85,
cl.lim=c(0,1), col=colorRampPalette(c("blue","#ffad33","#80ccff"))(20))
corrplot(mcor, method = 'circle',
type = 'upper', order = 'hclust', tl.col = 'black',
tl.srt = 45, tl.cex = 0.7, addCoef.col  = 'black', number.cex = 0.85,
cl.lim=c(0,1), col=colorRampPalette(c("blue","#ffad33","#80ccff"))(10))
#change resolution
png("corr_plot_viz1.png", width = 10, height = 10, units = 'in', res = 800)
corrplot(mcor, method = 'circle',
type = 'upper', order = 'hclust', tl.col = 'black',
tl.srt = 45, tl.cex = 0.7, addCoef.col  = 'black', number.cex = 0.85,
cl.lim=c(0,1), col=colorRampPalette(c("blue","#ffad33","#80ccff"))(10))
dev.off()
#change resolution
png("corr_plot_viz1.png", width = 10, height = 10, units = 'in', res = 800)
corrplot(mcor, method = 'circle',
type = 'upper', order = 'hclust', tl.col = 'black',
tl.srt = 45, tl.cex = 0.7, addCoef.col  = 'black', number.cex = 0.85,
cl.lim=c(0,1), col=colorRampPalette(c("blue","#ffad33","#80ccff"))(200))
dev.off()
corrplot(mcor, method = 'circle',
type = 'upper', order = 'hclust', tl.col = 'black',
tl.srt = 45, tl.cex = 0.7, addCoef.col  = 'black', number.cex = 0.85,
cl.lim=c(0,1), col=colorRampPalette(c("blue","gray","red"))(200))
corrplot(mcor, method = 'circle',
type = 'upper', order = 'hclust', tl.col = 'black',
tl.srt = 45, tl.cex = 0.7, addCoef.col  = 'black', number.cex = 0.85,
cl.lim=c(0,1), col=colorRampPalette(c("blue","white","red"))(200))
#change resolution
png("corr_plot_viz1.png", width = 10, height = 10, units = 'in', res = 800)
corrplot(mcor, method = 'circle',
type = 'upper', order = 'hclust', tl.col = 'black',
tl.srt = 45, tl.cex = 0.7, addCoef.col  = 'black', number.cex = 0.85,
cl.lim=c(0,1), col=colorRampPalette(c("blue","white","red"))(200))
dev.off()
